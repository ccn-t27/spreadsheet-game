<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è©¦ç®—è¡¨å‡½æ•¸å¤§æŒ‘æˆ° (é€£ç­†è¨˜)</title>
    <style>
        :root { --primary-color: #2563eb; --success-color: #16a34a; --error-color: #dc2626; --bg-color: #f3f4f6; --card-bg: #ffffff; }
        body { font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; background-color: var(--bg-color); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background-color: var(--card-bg); border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 800px; padding: 30px; text-align: center; overflow-y: auto; max-height: 90vh; position: relative; }
        
        /* é€šç”¨æ¨£å¼ */
        h1 { color: #333; margin-bottom: 10px; }
        h2 { color: #444; margin: 15px 0; }
        p { color: #666; line-height: 1.6; }
        .hidden { display: none !important; }
        
        /* æŒ‰éˆ•æ¨£å¼ */
        .btn { border: none; padding: 12px 25px; font-size: 1rem; border-radius: 8px; cursor: pointer; transition: transform 0.2s, background 0.3s; margin: 5px; font-weight: bold; display: inline-flex; align-items: center; justify-content: center; gap: 5px; }
        .btn:hover { transform: translateY(-2px); }
        .btn-primary { background-color: var(--primary-color); color: white; }
        .btn-secondary { background-color: #f59e0b; color: white; } /* é»ƒè‰² */
        .btn-danger { background-color: #ef4444; color: white; } /* ç´…è‰² */
        .btn-outline { background-color: white; border: 2px solid #e5e7eb; color: #555; }
        
        /* æ¸¬é©—å€æ¨£å¼ */
        .progress-bar { width: 100%; height: 10px; background-color: #e5e7eb; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background-color: var(--primary-color); width: 0%; transition: width 0.3s ease; }
        .question-text { font-size: 1.2rem; font-weight: bold; color: #1f2937; margin-bottom: 15px; }
        .hint-section { margin-bottom: 20px; }
        .btn-hint { background-color: #fffbeb; color: #d97706; border: 1px solid #fcd34d; font-size: 0.9rem; padding: 5px 15px; border-radius: 20px; cursor: pointer; display: inline-flex; align-items: center; gap: 5px; transition: all 0.2s; }
        .btn-hint:hover { background-color: #fcd34d; color: #78350f; }
        .hint-text { margin-top: 10px; background-color: #fff7ed; border: 1px dashed #fdba74; padding: 10px; border-radius: 8px; color: #9a3412; font-size: 0.9rem; display: none; animation: fadeIn 0.3s; }
        .hint-text.show { display: block; }

        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .option-btn { background-color: #f9fafb; border: 2px solid #e5e7eb; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.2s; font-family: monospace; font-weight: bold; }
        .option-btn:hover { border-color: var(--primary-color); background-color: #eff6ff; }
        
        /* å›é¥‹å€æ¨£å¼ */
        .feedback-container { margin-top: 20px; text-align: left; background-color: #f8fafc; padding: 20px; border-radius: 8px; border-left: 5px solid #ccc; }
        .feedback-container.correct { border-left-color: var(--success-color); }
        .feedback-container.wrong { border-left-color: var(--error-color); }
        .result-title { font-weight: bold; font-size: 1.2rem; margin-bottom: 10px; }
        .code-example { background-color: #1e293b; color: #a5f3fc; padding: 10px; border-radius: 5px; font-family: monospace; margin-top: 8px; display: block; word-break: break-all; }

        /* ç­†è¨˜å€æ¨£å¼ */
        .notes-nav { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; justify-content: center; border-bottom: 2px solid #eee; margin-bottom: 20px; }
        .nav-tab { padding: 8px 16px; border-radius: 20px; background: #f3f4f6; border: none; cursor: pointer; font-size: 0.9rem; white-space: nowrap; }
        .nav-tab.active { background: var(--primary-color); color: white; }
        .nav-tab.danger-zone { color: #dc2626; background: #fee2e2; }
        .nav-tab.danger-zone.active { background: #dc2626; color: white; }

        .cards-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; text-align: left; }
        .note-card { background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 15px; position: relative; transition: all 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .note-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-color: var(--primary-color); }
        
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .func-name { font-size: 1.2rem; font-weight: bold; color: var(--primary-color); }
        .func-icon { font-size: 1.5rem; }
        .speak-btn { background: none; border: none; cursor: pointer; opacity: 0.5; font-size: 1.2rem; }
        .speak-btn:hover { opacity: 1; transform: scale(1.1); }

        .hack-box { background: #fffbeb; color: #92400e; padding: 5px 10px; border-radius: 6px; font-size: 0.85rem; margin: 8px 0; font-weight: bold; border: 1px solid #fcd34d; }
        .root-word { font-family: monospace; background: #f3f4f6; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; color: #666; }
        
        .toggle-example { color: #3b82f6; font-size: 0.8rem; cursor: pointer; text-align: center; margin-top: 10px; display: block; }
        .example-content { background: #f0fdf4; border: 1px solid #bbf7d0; padding: 10px; border-radius: 6px; margin-top: 5px; display: none; }
        .example-content.show { display: block; }

        /* å°æ±ºå¡ç‰‡ */
        .versus-card { background: white; border: 2px solid #fee2e2; border-radius: 12px; overflow: hidden; margin-bottom: 15px; }
        .versus-header { background: #ef4444; color: white; padding: 8px; font-weight: bold; font-size: 1rem; }
        .versus-body { display: grid; grid-template-columns: 1fr 1fr; }
        .v-half { padding: 10px; font-size: 0.9rem; }
        .v-left { background: #eff6ff; border-right: 1px solid #e5e7eb; }
        .v-right { background: #fff7ed; }
        .key-point { font-weight: bold; display: block; margin-top: 5px; font-size: 0.8rem; }

        /* é¾è™æ¦œæ¨£å¼ */
        .input-group { margin: 20px 0; }
        input[type="text"] { padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; width: 70%; }
        .leaderboard-table { width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 0.9rem; }
        .leaderboard-table th { background: #f3f4f6; padding: 10px; text-align: center; }
        .leaderboard-table td { border-bottom: 1px solid #eee; padding: 10px; }
        .rank-1 { color: #eab308; font-weight: bold; }
        .rank-2 { color: #94a3b8; font-weight: bold; }
        .rank-3 { color: #b45309; font-weight: bold; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 480px) { .options-grid { grid-template-columns: 1fr; } .container { padding: 15px; } }
    </style>
</head>
<body>

<div class="container">
    <!-- 1. ä¸»é¸å–® (Start Screen) -->
    <div id="start-screen">
        <h1>ğŸ“Š è©¦ç®—è¡¨å‡½æ•¸å¤§å¸«</h1>
        <p>å­¸å‡½æ•¸ï¼Œå””ä½¿æ­»è¨˜ç¡¬èƒŒï¼<br>å…ˆæº«ç¿’ï¼Œå¾Œæ¸¬é©—ï¼Œçˆ­å¥ªé¾è™æ¦œç¬¬ä¸€åï¼</p>
        
        <div style="display: flex; flex-direction: column; gap: 10px; max-width: 300px; margin: 0 auto;">
            <button class="btn btn-secondary" onclick="showRevision()">ğŸ“– æº«ç¿’ç­†è¨˜ (æœ‰ç™¼éŸ³)</button>
            <button class="btn btn-primary" onclick="startGame()">ğŸ® é–‹å§‹æ¸¬é©— (10é¡Œ)</button>
        </div>
        <p style="font-size: 0.8rem; color: #999; margin-top: 20px;">Powered by IT Dog ğŸ¶</p>
    </div>

    <!-- 2. æº«ç¿’ç­†è¨˜å€ (Revision Screen) -->
    <div id="revision-screen" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h2 style="margin:0;">ğŸ¶ å‡½æ•¸è£œç¿’ç­</h2>
            <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;" onclick="goHome()">ğŸ  ä¸»é </button>
        </div>
        
        <div class="notes-nav">
            <button class="nav-tab active" onclick="switchTab('math')">ğŸ”¢ æ•¸å­¸</button>
            <button class="nav-tab" onclick="switchTab('logic')">ğŸ§  é‚è¼¯</button>
            <button class="nav-tab" onclick="switchTab('stats')">ğŸ“Š çµ±è¨ˆ</button>
            <button class="nav-tab danger-zone" onclick="switchTab('danger')">ğŸš¨ æ˜“æ··æ·†</button>
        </div>

        <div id="notes-content">
            <!-- å…§å®¹ç”± JS å‹•æ…‹ç”Ÿæˆ -->
        </div>

        <button class="btn btn-primary" style="margin-top: 20px; width: 100%;" onclick="startGame()">æˆ‘æº«å®Œæ›¸äº†ï¼å»æ¸¬é©— â¡ï¸</button>
    </div>

    <!-- 3. æ¸¬é©—å€ (Quiz Screen) -->
    <div id="quiz-screen" class="hidden">
        <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
        
        <div class="question-text" id="question">è¼‰å…¥ä¸­...</div>
        
        <!-- æ–°å¢ï¼šæç¤ºå€åŸŸ -->
        <div class="hint-section">
            <button class="btn-hint" onclick="toggleHint()">ğŸ’¡ æç¤º (Hint)</button>
            <div id="hint-text" class="hint-text"></div>
        </div>

        <div class="options-grid" id="options-container"></div>
    </div>

    <!-- 4. å›é¥‹å€ (Feedback Screen) -->
    <div id="feedback-screen" class="hidden">
        <div class="feedback-container" id="feedback-box">
            <div class="result-title" id="result-title"></div>
            <div class="explanation-box">
                <p id="explanation-text"></p>
                <strong>ğŸ’¡ ä¾‹å­ï¼š</strong>
                <code class="code-example" id="example-code"></code>
            </div>
        </div>
        <button class="btn btn-primary btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
    </div>

    <!-- 5. çµæŸèˆ‡é¾è™æ¦œ (End Screen) -->
    <div id="end-screen" class="hidden">
        <h1>ğŸ‰ æŒ‘æˆ°å®Œæˆï¼</h1>
        <p>ä½ çš„å¾—åˆ†ï¼š <span style="font-size: 2rem; font-weight:bold; color: var(--primary-color);"><span id="final-score">0</span> / <span id="total-questions">0</span></span></p>
        
        <div id="submit-section">
            <p>è¼¸å…¥åå­—ï¼Œç™»ä¸Šé¾è™æ¦œï¼</p>
            <div class="input-group">
                <input type="text" id="player-name" placeholder="ä½ çš„åå­—æˆ–å­¸è™Ÿ" maxlength="10">
                <button class="btn btn-primary btn-submit" onclick="submitScore()">æäº¤æˆç¸¾</button>
            </div>
            <!-- æ–°å¢ï¼šä¸ç•™åå›ä¸»é æŒ‰éˆ• -->
            <div style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 15px;">
                <button class="btn btn-outline" onclick="goHome()">ğŸ  ä¸æƒ³ç•™åï¼Ÿç›´æ¥å›ä¸»é </button>
            </div>
        </div>

        <div id="leaderboard-section" class="hidden">
            <h3>ğŸ† é¾è™æ¦œ (Top 10)</h3>
            <div id="leaderboard-content" style="color: #999;">è¼‰å…¥ä¸­...</div>
            <div style="margin-top: 20px;">
                <button class="btn btn-outline" onclick="goHome()">ğŸ  å›ä¸»é </button>
                <button class="btn btn-primary" onclick="startGame()">å†ç©ä¸€æ¬¡</button>
            </div>
        </div>
    </div>
</div>

<script>
    // ==========================================
    // âš ï¸ è¨˜å¾—å°‡ä¸‹é¢é€™è¡Œæ›æˆä½ çš„ Google Apps Script ç¶²å€
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxkhEO_36rhZEu63NdufMgag1DgWz4eBlyhbbf0kKuD6DqrVb7tlfGeUIZ-_USVj6zs/exec"; 
    // ==========================================

    // --- è³‡æ–™åº«ï¼šç­†è¨˜å…§å®¹ ---
    const notesData = {
        math: [
            { name: "SUM", pronounce: "Sum", root: "Summary", icon: "ğŸ’°", hack: "å…¨éƒ¨'æ£®'åŸ‹ä¸€é½Š", desc: "åŠ ç¸½", example: "=SUM(A1:A10)", res: "ç¸½å’Œ" },
            { name: "SUMIF", pronounce: "Sum If", root: "Sum + If", icon: "ğŸ§", hack: "æŸ¥é‚Šåº¦, æŸ¥å’©, åŠ é‚Šåº¦ (3æ ¼)", desc: "æ¢ä»¶åŠ ç¸½", example: "=SUMIF(A1:A10, \"Peter\", B1:B10)", res: "Peterçš„ç¸½åˆ†" },
            { name: "ABS", pronounce: "Abs", root: "Absolute", icon: "â•", hack: "å……æ»¿æ­£èƒ½é‡ (è®Šæ­£æ•¸)", desc: "çµ•å°å€¼", example: "=ABS(-50)", res: "50" },
            { name: "INT", pronounce: "Int", root: "Integer", icon: "ğŸª“", hack: "ç›´æ¥æ–¬è…³è¶¾ (æ¨å»å°æ•¸)", desc: "å–æ•´", example: "=INT(5.99)", res: "5" },
            { name: "ROUND", pronounce: "Round", root: "Round", icon: "â­•", hack: "åšäººè¦åœ“æ»‘ (å››æ¨äº”å…¥)", desc: "å››æ¨äº”å…¥", example: "=ROUND(5.99, 1)", res: "6.0" },
            { name: "SQRT", pronounce: "Square Root", root: "Square Root", icon: "ğŸŒ¿", hack: "SQ=æ­£æ–¹å½¢ Root=æ ¹", desc: "å¹³æ–¹æ ¹", example: "=SQRT(16)", res: "4" },
            { name: "RAND", pronounce: "Rand", root: "Random", icon: "ğŸ²", hack: "éš¨æ©ŸæŠ½ç", desc: "éš¨æ©Ÿæ•¸", example: "=RAND()", res: "0.238..." },
        ],
        logic: [
            { name: "IF", pronounce: "If", root: "If", icon: "ğŸ¤”", hack: "å¦‚æœ...å°±...å¦å‰‡...", desc: "æ¢ä»¶åˆ¤æ–·", example: "=IF(A1>=50, 'åŠæ ¼', 'è‚¥ä½¬')", res: "åŠæ ¼/è‚¥ä½¬" },
            { name: "AND", pronounce: "And", root: "And", icon: "ğŸ¤", hack: "A åŒåŸ‹ B (è²ªå¿ƒï¼Œå…©å€‹éƒ½è¦)", desc: "è€Œä¸”", example: "=AND(ä¸­>50, è‹±>50)", res: "TRUE" },
            { name: "OR", pronounce: "Or", root: "Or", icon: "ğŸ¤·", hack: "A æˆ–è€… B (éš¨ä¾¿ï¼Œä¸€å€‹å°±å¾—)", desc: "æˆ–è€…", example: "=OR(ä¸­>50, è‹±>50)", res: "TRUE" },
            { name: "NOT", pronounce: "Not", root: "Not", icon: "ğŸ™…", hack: "å”±åèª¿ (é»‘è®Šç™½)", desc: "ç›¸å", example: "=NOT(TRUE)", res: "FALSE" },
        ],
        stats: [
            { name: "AVERAGE", pronounce: "Average", root: "Average", icon: "âš–ï¸", hack: "Avg (å¹³å‡åˆ†)", desc: "å¹³å‡å€¼", example: "=AVERAGE(A1:A30)", res: "å¹³å‡åˆ†" },
            { name: "COUNT", pronounce: "Count", root: "Count", icon: "ğŸ”¢", hack: "é æ‰‹æŒ‡æ•¸æ•¸å­—", desc: "æ•¸æ•¸å­—", example: "=COUNT(A1:A10)", res: "å€‹æ•¸" },
            { name: "COUNTA", pronounce: "Count A", root: "Count All", icon: "ğŸ” ", hack: "Count All (å…¨éƒ¨éƒ½æ•¸)", desc: "æ•¸éç©ºå€¼", example: "=COUNTA(A1:A10)", res: "å€‹æ•¸" },
            { name: "COUNTBLANK", pronounce: "Count Blank", root: "Count Blank", icon: "â¬œ", hack: "Blank å³ä¿‚ç™½å· (ç©ºæ ¼)", desc: "æ•¸ç©ºæ ¼", example: "=COUNTBLANK(A1:A10)", res: "ç©ºæ ¼æ•¸" },
            { name: "COUNTIF", pronounce: "Count If", root: "Count + If", icon: "ğŸ‘†", hack: "æŸ¥é‚Šåº¦, æŸ¥å’© (2æ ¼)", desc: "æ¢ä»¶è¨ˆæ•¸", example: "=COUNTIF(A1:A10, \"M\")", res: "äººæ•¸" },
            { name: "MAX", pronounce: "Max", root: "Maximum", icon: "ğŸ”ï¸", hack: "Max å“¥æœ€å¼· (æœ€å¤§)", desc: "æœ€å¤§å€¼", example: "=MAX(A1:A30)", res: "æœ€å¤§å€¼" },
            { name: "MIN", pronounce: "Min", root: "Minimum", icon: "ğŸœ", hack: "Mini å¼Ÿè¿·ä½  (æœ€å°)", desc: "æœ€å°å€¼", example: "=MIN(A1:A30)", res: "æœ€å°å€¼" },
            { name: "RANK", pronounce: "Rank", root: "Ranking", icon: "ğŸ†", hack: "æ‰“æ©Ÿ Ranking (æ’å)", desc: "æ’å", example: "=RANK(A1, A$1:A$30)", res: "åæ¬¡" },
            { name: "LARGE", pronounce: "Large", root: "Large", icon: "ğŸ¥ˆ", hack: "ç¬¬ K å¤§", desc: "ç¬¬Kå¤§å€¼", example: "=LARGE(A1:A10, 2)", res: "ç¬¬2å¤§" },
            { name: "SMALL", pronounce: "Small", root: "Small", icon: "ğŸ¢", hack: "ç¬¬ K ç´°", desc: "ç¬¬Kå°å€¼", example: "=SMALL(A1:A10, 3)", res: "ç¬¬3å°" },
        ]
    };

    const confusingPairs = [
        {
            title: "SUMIF vs COUNTIF",
            keyword: "åŠ éŒ¢ vs æ•¸äºº",
            desc: "SUMIF å¡« 3 æ ¼ï¼ŒCOUNTIF å¡« 2 æ ¼ã€‚",
            left: { name: "SUMIF", icon: "ğŸ’µ", meaning: "Sum (åŠ ç¸½) + If", key: "æŸ¥é‚Šåº¦, æŸ¥å’©, åŠ é‚Šåº¦ (3æ ¼)" },
            right: { name: "COUNTIF", icon: "ğŸ‘†", meaning: "Count (è¨ˆæ•¸) + If", key: "æŸ¥é‚Šåº¦, æŸ¥å’© (2æ ¼)" }
        },
        {
            title: "COUNT vs COUNTA",
            keyword: "æ•¸å­— vs å…¨éƒ¨",
            desc: "å¦‚æœ‰æ–‡å­— (å¦‚ 'ç¼ºå¸­')ï¼Œç”¨ COUNT æœƒæ•¸æ¼ï¼",
            left: { name: "COUNT", icon: "ğŸ”¢", meaning: "åªæ•¸æ•¸å­—", key: "1, 2, 3..." },
            right: { name: "COUNTA", icon: "ğŸ” ", meaning: "All (å…¨éƒ¨)", key: "æ•¸å­— + æ–‡å­—" }
        },
        {
            title: "INT vs ROUND",
            keyword: "æ–¬è…³ vs å››æ¨äº”å…¥",
            desc: "INT æœ€æš´åŠ›ï¼ŒROUND ç‡æƒ…æ³ã€‚",
            left: { name: "INT", icon: "ğŸª“", meaning: "Integer (å–æ•´)", key: "ç„¡æ¢ä»¶æ¨å»" },
            right: { name: "ROUND", icon: "â­•", meaning: "Round (åœ“æ»‘)", key: "å››æ¨äº”å…¥" }
        }
    ];

    // --- è³‡æ–™åº«ï¼šé¡Œç›® (45é¡Œ) - æ–°å¢ hint (æç¤º) ---
    const questionBank = [
        { question: "è¨ˆç®—å…¨ç­æ¸¬é©—åˆ†æ•¸çš„ã€Œç¸½å’Œã€ã€‚", options: ["SUM", "TOTAL", "ADD", "COUNT"], answer: 0, explanation: "SUM ç”¨æ–¼è¨ˆç®—é¸å®šç¯„åœå…§æ‰€æœ‰æ•¸å­—çš„ç¸½å’Œã€‚", example: "=SUM(A1:A10)", hint: "Keyword: Summary (ç¸½çµ)ã€‚å°‡æ‰€æœ‰æ•¸å­—åŠ èµ·ä¾†ã€‚" },
        { question: "è¨ˆç®—å…¨ç­çš„ã€Œå¹³å‡åˆ†ã€ã€‚", options: ["MEAN", "AVERAGE", "MEDIAN", "SUM"], answer: 1, explanation: "AVERAGE ç”¨æ–¼è¨ˆç®—ç®—è¡“å¹³å‡å€¼ã€‚", example: "=AVERAGE(A1:A30)", hint: "Keyword: Avgã€‚å¹³æ™‚ç®—æˆç¸¾å¸¸ç”¨çš„ã€‚" },
        { question: "å¦‚æœä½ æƒ³è¨ˆç®— 5 å€‹ç§‘ç›®çš„ç¸½åˆ†ï¼Œé™¤äº†ç”¨ A1+B1+... å¤–ï¼Œæœ€å¿«çš„æ–¹æ³•æ˜¯ï¼Ÿ", options: ["ADD", "SUM", "PLUS", "TOTAL"], answer: 1, explanation: "SUM å¯ä»¥ç›´æ¥é¸å–ä¸€å€‹ç¯„åœé€²è¡ŒåŠ ç¸½ã€‚", example: "=SUM(A1:E1)", hint: "æœ€åŸºæœ¬çš„åŠ ç¸½å‡½æ•¸ã€‚" },
        { question: "è¨ˆç®— 1 æœˆåˆ° 12 æœˆçš„å¹³å‡æ”¯å‡ºï¼Œå¿½ç•¥æ²’æœ‰è¼¸å…¥æ•¸å­—çš„æœˆä»½ã€‚", options: ["AVERAGE", "SUM", "COUNT", "INT"], answer: 0, explanation: "AVERAGE å‡½æ•¸æœƒè‡ªå‹•å¿½ç•¥ç©ºç™½å„²å­˜æ ¼ã€‚", example: "=AVERAGE(B2:B13)", hint: "Keyword: Avgã€‚" },
        { question: "æƒ³è¦å°‡ä¸‰å€‹ä¸é€£çºŒçš„å„²å­˜æ ¼ A1, C1, E1 åŠ ç¸½ã€‚", options: ["SUM", "ADD", "PLUS", "TOTAL"], answer: 0, explanation: "SUM å¯ä»¥æ¥å—å¤šå€‹ä¸é€£çºŒçš„åƒæ•¸ï¼Œç”¨é€—è™Ÿéš”é–‹ã€‚", example: "=SUM(A1, C1, E1)", hint: "åŠ ç¸½ç”¨çš„å‡½æ•¸æ˜¯...?" },
        { question: "æ‰¾å‡ºå…¨ç­åˆ†æ•¸ã€Œæœ€é«˜ã€çš„é‚£ä½åŒå­¸çš„åˆ†æ•¸ã€‚", options: ["TOP", "LARGE", "MAX", "RANK"], answer: 2, explanation: "MAX å‡½æ•¸ç”¨æ–¼å›å‚³æœ€å¤§å€¼ã€‚", example: "=MAX(C1:C30)", hint: "Keyword: Maximum (æœ€å¤§)ã€‚" },
        { question: "æ‰¾å‡ºé€™æ¬¡è€ƒè©¦ä¸­ã€Œæœ€ä½ã€çš„åˆ†æ•¸ã€‚", options: ["MIN", "SMALL", "LOW", "BOTTOM"], answer: 0, explanation: "MIN å‡½æ•¸ç”¨æ–¼å›å‚³æœ€å°å€¼ã€‚", example: "=MIN(C1:C30)", hint: "Keyword: Minimum (æœ€å°)ã€‚" },
        { question: "æƒ³æ‰¾å‡ºå…¨ç­åˆ†æ•¸ã€Œç¬¬ä¸‰é«˜ã€çš„åˆ†æ•¸ï¼ŒMAX åšä¸åˆ°ï¼Œè©²ç”¨ä»€éº¼ï¼Ÿ", options: ["MAX", "LARGE", "RANK", "HIGH"], answer: 1, explanation: "LARGE(ç¯„åœ, k) å¯ä»¥æ‰¾å‡ºç¬¬ k å€‹æœ€å¤§å€¼ã€‚", example: "=LARGE(A1:A10, 3)", hint: "Keyword: Largeã€‚æ¯” Max æ›´éˆæ´»ï¼Œå¯ä»¥æŒ‡å®šç¬¬å¹¾å¤§ã€‚" },
        { question: "æƒ³æ‰¾å‡ºå…¨ç­è·‘å¾—ã€Œç¬¬äºŒå¿«ã€çš„æ™‚é–“ (æ•¸å€¼è¶Šå°è¶Šå¿«ï¼Œå³ç¬¬äºŒå°å€¼)ã€‚", options: ["MIN", "SMALL", "LOWER", "BOTTOM"], answer: 1, explanation: "SMALL(ç¯„åœ, k) å¯ä»¥æ‰¾å‡ºç¬¬ k å€‹æœ€å°å€¼ã€‚", example: "=SMALL(A1:A10, 2)", hint: "Keyword: Smallã€‚æ‰¾ç¬¬ K å€‹å°çš„å€¼ã€‚" },
        { question: "è¦æ‰¾å‡ºå…¬å¸è£¡è–ªæ°´ã€Œç¬¬äº”é«˜ã€çš„é‡‘é¡ã€‚", options: ["RANK", "LARGE", "MAX", "COUNT"], answer: 1, explanation: "ä½¿ç”¨ LARGE å‡½æ•¸ï¼Œè¨­å®š k=5ã€‚", example: "=LARGE(B2:B100, 5)", hint: "æ‰¾ç¬¬ K å¤§çš„æ•¸ã€‚" },
        { question: "è¨ˆç®—ä¸€åˆ—è³‡æ–™ä¸­æœ‰ã€Œå¤šå°‘å€‹æ•¸å­—ã€ï¼ˆä¸åŒ…å«æ–‡å­—ï¼‰ã€‚", options: ["COUNTA", "COUNT", "COUNTBLANK", "SUM"], answer: 1, explanation: "COUNT åªè¨ˆç®—ã€Œæ•¸å­—ã€ï¼›COUNTA ç®—æ‰€æœ‰éç©ºå€¼ã€‚", example: "=COUNT(A1:A10)", hint: "åªæ•¸æ•¸å­— (1, 2, 3...)ï¼Œä¸æ•¸æ–‡å­—ã€‚" },
        { question: "è¨ˆç®—å‡ºå¸­åå–®ä¸­æœ‰å¡«å¯«è³‡æ–™çš„ç¸½äººæ•¸ï¼ˆç„¡è«–å¡«æ–‡å­—æˆ–æ•¸å­—ï¼‰ã€‚", options: ["COUNT", "COUNTA", "SUM", "TOTAL"], answer: 1, explanation: "COUNTA (Count All) è¨ˆç®—æ‰€æœ‰ã€Œéç©ºç™½ã€å„²å­˜æ ¼ã€‚", example: "=COUNTA(A1:A10)", hint: "Keyword: Count Allã€‚æ–‡å­—æ•¸å­—é€šæ®ºã€‚" },
        { question: "è¨ˆç®—è³‡æ–™ç¯„åœä¸­æœ‰å¤šå°‘å€‹ã€Œç©ºæ ¼ã€ï¼ˆç¼ºå¸­/æœªå¡«ï¼‰ã€‚", options: ["COUNT", "EMPTY", "COUNTBLANK", "NULL"], answer: 2, explanation: "COUNTBLANK å°ˆé–€è¨ˆç®—ç©ºç™½å„²å­˜æ ¼ã€‚", example: "=COUNTBLANK(A1:A10)", hint: "Keyword: Blank (ç©ºç™½)ã€‚" },
        { question: "å¦‚æœå„²å­˜æ ¼è£¡æ˜¯æ–‡å­— 'Absent'ï¼Œç”¨ COUNT å‡½æ•¸è¨ˆç®—æœƒå¾—åˆ°ä»€éº¼ï¼Ÿ", options: ["1", "0", "éŒ¯èª¤", "TRUE"], answer: 1, explanation: "COUNT åªç®—æ•¸å­—ï¼Œå¿½ç•¥æ–‡å­—ã€‚è¦ç®—æ–‡å­—éœ€ç”¨ COUNTAã€‚", example: "=COUNT(\"Absent\") // çµæœç‚º 0", hint: "COUNT å¾ˆæŒ‘é£Ÿï¼Œåªåƒæ•¸å­—ã€‚" },
        { question: "æƒ³çŸ¥é“æœ‰å¤šå°‘åŒå­¸ã€Œæ²’æœ‰ã€æäº¤ä½œæ¥­ (è©²æ¬„ä½ç‚ºç©ºç™½)ã€‚", options: ["COUNT", "COUNTA", "COUNTBLANK", "MIN"], answer: 2, explanation: "è¨ˆç®—ç©ºç™½æ ¼çš„æ•¸é‡ï¼Œä½¿ç”¨ COUNTBLANKã€‚", example: "=COUNTBLANK(C2:C40)", hint: "æ‰¾ç©ºç™½çš„æ ¼ä»”ã€‚" },
        { question: "åªæƒ³åŠ ç¸½ã€ŒåŠæ ¼ã€ï¼ˆåˆ†æ•¸ >= 50ï¼‰åŒå­¸çš„åˆ†æ•¸ã€‚", options: ["SUM", "SUMIF", "COUNTIF", "IF"], answer: 1, explanation: "SUMIF å…è¨±ä½ è¨­å®šä¸€å€‹æ¢ä»¶ï¼Œç¬¦åˆæ‰åŠ ç¸½ã€‚", example: "=SUMIF(A1:A10, \">=50\")", hint: "åŠ ç¸½ (Sum) + æ¢ä»¶ (If)ã€‚" },
        { question: "è¨ˆç®—ç­ä¸Šã€Œç”·åŒå­¸ã€çš„ç¸½äººæ•¸ (è³‡æ–™ç‚º 'M')ã€‚", options: ["COUNT", "SUMIF", "COUNTIF", "COUNTA"], answer: 2, explanation: "COUNTIF è¨ˆç®—ç¬¦åˆç‰¹å®šæ¢ä»¶çš„å€‹æ•¸ã€‚", example: "=COUNTIF(B2:B20, \"M\")", hint: "æ•¸äººé ­ (Count) + æ¢ä»¶ (If)ã€‚" },
        { question: "è¨ˆç®—æ‰€æœ‰ã€Œå¤§æ–¼ 1000 å…ƒã€çš„è¨‚å–®æ•¸é‡ã€‚", options: ["COUNT", "COUNTIF", "SUMIF", "LARGE"], answer: 1, explanation: "COUNTIF å¯ä»¥è¨­å®šæ•¸å­—æ¢ä»¶ï¼Œä¾‹å¦‚ \">1000\"ã€‚", example: "=COUNTIF(C2:C100, \">1000\")", hint: "å•æ•¸é‡ (How many)ï¼Œä¸æ˜¯å•ç¸½é‡‘é¡ã€‚" },
        { question: "æƒ³è¨ˆç®—ã€Œæ–‡å…·éƒ¨ã€çš„ç¸½éŠ·å”®é¡ (éƒ¨é–€åœ¨ A æ¬„ï¼Œé‡‘é¡åœ¨ B æ¬„)ã€‚", options: ["SUM", "SUMIF", "DSUM", "TOTALIF"], answer: 1, explanation: "SUMIF(ç¯„åœ, æ¢ä»¶, åŠ ç¸½ç¯„åœ)ã€‚", example: "=SUMIF(A:A, \"æ–‡å…·éƒ¨\", B:B)", hint: "å•ç¸½é‡‘é¡ (Total)ï¼Œä¸æ˜¯å•æ•¸é‡ã€‚" },
        { question: "è¨ˆç®—æœ‰å¤šå°‘å€‹å­¸ç”Ÿçš„æˆç¸¾æ˜¯ã€Œ100 åˆ†ã€æ»¿åˆ†ã€‚", options: ["MAX", "COUNT", "COUNTIF", "RANK"], answer: 2, explanation: "COUNTIF å¯ä»¥ç²¾ç¢ºè¨ˆç®—ç­‰æ–¼æŸå€‹æ•¸å€¼çš„å€‹æ•¸ã€‚", example: "=COUNTIF(D2:D40, 100)", hint: "æ•¸æ•¸çœ‹æœ‰å¹¾å€‹ (Count... If...)" },
        { question: "è¨ˆç®—æœ‰å¤šå°‘å€‹æˆç¸¾æ˜¯ã€Œä¸åŠæ ¼ã€çš„ (<60)ã€‚", options: ["COUNT", "SUMIF", "COUNTIF", "IF"], answer: 2, explanation: "COUNTIF ç”¨æ–¼è¨ˆç®—ç¬¦åˆæ¢ä»¶çš„å„²å­˜æ ¼æ•¸é‡ã€‚", example: "=COUNTIF(A1:A10, \"<60\")", hint: "æ•¸æ•¸é‡ (Count) + æ¢ä»¶ (<60)ã€‚" },
        { question: "æƒ³çŸ¥é“æŸä½åŒå­¸çš„åˆ†æ•¸åœ¨å…¨ç­æ’ç¬¬å¹¾åã€‚", options: ["SORT", "ORDER", "RANK", "LEVEL"], answer: 2, explanation: "RANK å‚³å›æŸæ•¸å€¼åœ¨åˆ—è¡¨ä¸­çš„æ’åã€‚", example: "=RANK(A2, A$2:A$40)", hint: "Keyword: Ranking (æ’å)ã€‚æ‰“æ©Ÿå¸¸è¦‹ã€‚" },
        { question: "çµ±è¨ˆå­¸ä¸­ï¼Œæƒ³æ‰¾å‡ºé€™çµ„åˆ†æ•¸çš„ã€Œä¸­ä½æ•¸ã€ï¼ˆä¸­é–“é‚£å€‹æ•¸ï¼‰ã€‚", options: ["MIDDLE", "MEDIAN", "AVERAGE", "MODE"], answer: 1, explanation: "MEDIAN æ‰¾å‡ºæ•¸å€¼ç¾¤çµ„ä¸­é–“çš„æ•¸å€¼ï¼Œé¿å…è¢«æ¥µç«¯å€¼å½±éŸ¿ã€‚", example: "=MEDIAN(A1:A10)", hint: "Keyword: Middle -> Medianã€‚" },
        { question: "çµ±è¨ˆå­¸ä¸­ï¼Œæƒ³æ‰¾å‡ºé€™çµ„åˆ†æ•¸ä¸­ã€Œå‡ºç¾æ¬¡æ•¸æœ€å¤šã€çš„åˆ†æ•¸ï¼ˆçœ¾æ•¸ï¼‰ã€‚", options: ["MOST", "MAX", "MODE", "POPULAR"], answer: 2, explanation: "MODE å‚³å›å‡ºç¾é »ç‡æœ€é«˜çš„æ•¸å€¼ã€‚", example: "=MODE(A1:A10)", hint: "Keyword: Most -> Modeã€‚" },
        { question: "å¦‚æœæœ‰ä¸€çµ„æ•¸å­—ï¼š1, 2, 9, 9, 10ã€‚MODE å‡½æ•¸çš„çµæœæ˜¯ï¼Ÿ", options: ["1", "9", "6.2", "10"], answer: 1, explanation: "MODE æ‰¾çœ¾æ•¸ï¼ˆå‡ºç¾æœ€å¤šæ¬¡çš„æ•¸ï¼‰ï¼Œ9 å‡ºç¾äº†å…©æ¬¡ã€‚", example: "=MODE(A1:A5)", hint: "æ‰¾å‡ºç¾æœ€å¤šæ¬¡çš„æ•¸ (Most -> Mode)ã€‚" },
        { question: "RANK å‡½æ•¸å¦‚æœä¸æŒ‡å®šç¬¬ä¸‰å€‹åƒæ•¸ï¼Œé è¨­æ’åæ–¹å¼æ˜¯ï¼Ÿ", options: ["éå¢ (åˆ†æ•¸ä½ç¬¬ä¸€å)", "éæ¸› (åˆ†æ•¸é«˜ç¬¬ä¸€å)", "éš¨æ©Ÿ", "ä¾è¼¸å…¥é †åº"], answer: 1, explanation: "RANK é è¨­æ˜¯éæ¸›æ’åº (Desc)ï¼Œå³æ•¸å­—è¶Šå¤§æ’åè¶Šå‰ã€‚", example: "=RANK(A1, A1:A10)", hint: "é€šå¸¸åˆ†æ•¸è¶Šé«˜ï¼Œæ’åè¶Šå‰ (1, 2, 3...)ã€‚" },
        { question: "å¦‚æœ A1>=60 é¡¯ç¤ºã€ŒåŠæ ¼ã€ï¼Œå¦å‰‡é¡¯ç¤ºã€Œä¸åŠæ ¼ã€ã€‚", options: ["CHECK", "IF", "THEN", "WHEN"], answer: 1, explanation: "IF(æ¢ä»¶, æˆç«‹å€¼, ä¸æˆç«‹å€¼)ã€‚", example: "=IF(A1>=60, \"åŠæ ¼\", \"ä¸åŠæ ¼\")", hint: "Keyword: If (å¦‚æœ)ã€‚" },
        { question: "åˆ¤æ–·æ˜¯å¦ã€Œå…©ç§‘éƒ½åŠæ ¼ã€ã€‚æ¢ä»¶ï¼šä¸­æ–‡>50 ä¸” è‹±æ–‡>50ã€‚", options: ["OR", "IF", "AND", "BOTH"], answer: 2, explanation: "AND åœ¨ã€Œæ‰€æœ‰ã€æ¢ä»¶éƒ½ç‚º TRUE æ™‚æ‰å›å‚³ TRUEã€‚", example: "=AND(A1>50, B1>50)", hint: "å…©å€‹éƒ½è¦ (And)ã€‚" },
        { question: "åˆ¤æ–·æ˜¯å¦ã€Œè‡³å°‘æœ‰ä¸€ç§‘åŠæ ¼ã€ã€‚æ¢ä»¶ï¼šä¸­æ–‡>50 æˆ– è‹±æ–‡>50ã€‚", options: ["AND", "OR", "IF", "MAYBE"], answer: 1, explanation: "OR åªè¦æœ‰ã€Œä»»ä½•ä¸€å€‹ã€æ¢ä»¶ç‚º TRUE å°±å›å‚³ TRUEã€‚", example: "=OR(A1>50, B1>50)", hint: "æˆ–è€… (Or)ï¼Œå…¶ä¸­ä¸€å€‹å°±å¾—ã€‚" },
        { question: "å°‡ TRUE è®Šæˆ FALSEï¼Œæˆ–å°‡ FALSE è®Šæˆ TRUEã€‚", options: ["SWAP", "IF", "NOT", "CHANGE"], answer: 2, explanation: "NOT ç”¨æ–¼åè½‰é‚è¼¯å€¼ã€‚", example: "=NOT(TRUE) // çµæœç‚º FALSE", hint: "å”±åèª¿ã€‚" },
        { question: "æƒ³æ ¹æ“šå¹´é½¡çµ¦äºˆå„ªæƒ ï¼šå¦‚æœ Age<12 æˆ– Age>60ï¼Œé¡¯ç¤º \"åŠåƒ¹\"ï¼Œå¦å‰‡ \"åŸåƒ¹\"ã€‚", options: ["AND", "OR", "IF+OR", "IF+AND"], answer: 2, explanation: "éœ€è¦ IF æ­é… ORã€‚å¦‚æœ (å°æ–¼12 æˆ– å¤§æ–¼60) æˆç«‹...", example: "=IF(OR(A1<12, A1>60), \"åŠåƒ¹\", \"åŸåƒ¹\")", hint: "å°æ–¼12ã€æˆ–è€…ã€‘å¤§æ–¼60ã€‚" },
        { question: "æª¢æŸ¥åº«å­˜ï¼šå¦‚æœæ•¸é‡å°æ–¼ 5ï¼Œé¡¯ç¤º \"è£œè²¨\"ï¼Œå¦å‰‡é¡¯ç¤ºç©ºç™½ã€‚", options: ["IF", "COUNTIF", "CHECK", "AND"], answer: 0, explanation: "IF å‡½æ•¸æœ€é©åˆé€™ç¨®äºŒé¸ä¸€çš„æƒ…æ³ã€‚", example: "=IF(A2<5, \"è£œè²¨\", \"\")", hint: "å¦‚æœ...å°±... (If)ã€‚" },
        { question: "åªæœ‰ç•¶ A1 å’Œ B1 éƒ½ç­‰æ–¼ \"Yes\" æ™‚æ‰é¡¯ç¤º \"Pass\"ã€‚", options: ["IF+OR", "IF+AND", "COUNTIF", "SUMIF"], answer: 1, explanation: "éœ€è¦ IF è£¡é¢åŒ…ä¸€å€‹ ANDã€‚", example: "=IF(AND(A1=\"Yes\", B1=\"Yes\"), \"Pass\", \"\")", hint: "å¦‚æœ (If) å…©å€‹éƒ½ (And) æ˜¯ Yesã€‚" },
        { question: "éœ€è¦è¨ˆç®—ä¸€å€‹æ•¸å€¼çš„ã€Œçµ•å°å€¼ã€ï¼ˆå°‡è² æ•¸è®Šæ­£æ•¸ï¼‰ã€‚", options: ["ABS", "INT", "POS", "ROUND"], answer: 0, explanation: "ABS (Absolute) å›å‚³çµ•å°å€¼ã€‚", example: "=ABS(-15) // çµæœ 15", hint: "Keyword: Absolute (çµ•å°)ã€‚" },
        { question: "å°‡ 3.14159 å››æ¨äº”å…¥åˆ°ã€Œå°æ•¸é»å¾Œå…©ä½ã€ã€‚", options: ["INT", "ROUND", "ROUNDUP", "FIXED"], answer: 1, explanation: "ROUND(æ•¸å­—, ä½æ•¸) ç”¨æ–¼å››æ¨äº”å…¥ã€‚", example: "=ROUND(3.14159, 2) // 3.14", hint: "Keyword: Round (åœ“æ»‘)ã€‚" },
        { question: "åªæƒ³ä¿ç•™æ•¸å­—çš„ã€Œæ•´æ•¸éƒ¨åˆ†ã€ï¼Œç„¡æ¢ä»¶æ¨å»å°æ•¸ï¼ˆä¾‹ 5.9 è®Š 5ï¼‰ã€‚", options: ["ROUND", "ABS", "INT", "FLOOR"], answer: 2, explanation: "INT å‘ä¸‹å–æ•´è‡³æœ€æ¥è¿‘çš„æ•´æ•¸ã€‚", example: "=INT(5.99) // 5", hint: "Keyword: Integer (æ•´æ•¸)ã€‚ç›´æ¥æ–¬è…³ã€‚" },
        { question: "è¨ˆç®— 144 çš„ã€Œå¹³æ–¹æ ¹ã€ã€‚", options: ["SQRT", "SQUARE", "POWER", "ROOT"], answer: 0, explanation: "SQRT (Square Root) è¨ˆç®—å¹³æ–¹æ ¹ã€‚", example: "=SQRT(144) // 12", hint: "Square Root çš„ç¸®å¯«ã€‚" },
        { question: "å¦‚æœè¦è¨ˆç®—å…©å€‹åœ°é»çš„è·é›¢å·® (A1 - B1)ï¼Œä½†ä¸å¸Œæœ›å‡ºç¾è² æ•¸ã€‚", options: ["IF", "INT", "ABS", "MIN"], answer: 2, explanation: "ç”¨ ABS åŒ…ä½ç›¸æ¸›çš„å…¬å¼ï¼Œç¢ºä¿çµæœæ°¸é æ˜¯æ­£æ•¸ã€‚", example: "=ABS(A1-B1)", hint: "è·é›¢ä¸€å®šæ˜¯æ­£æ•¸ -> çµ•å°å€¼ã€‚" },
        { question: "æƒ³æŠŠå…¨ç­å¹³å‡åˆ† 85.6789 è®Šæˆæ•´æ•¸ 86 (å››æ¨äº”å…¥)ã€‚", options: ["INT", "ROUND", "TRUNC", "ABS"], answer: 1, explanation: "ROUND å¯ä»¥å››æ¨äº”å…¥ï¼›INT æœƒè®Šæˆ 85ã€‚", example: "=ROUND(85.6789, 0)", hint: "å››æ¨äº”å…¥ -> Roundã€‚" },
        { question: "INT(-5.5) çš„çµæœæ˜¯å¤šå°‘ï¼Ÿ", options: ["-5", "-6", "-5.5", "5"], answer: 1, explanation: "INT æ˜¯ã€Œå‘ä¸‹ã€å–æ•´ï¼Œ-5.5 å‘ä¸‹æ˜¯ -6ã€‚", example: "=INT(-5.5)", hint: "INT æ˜¯å‘å°æ•¸æ–¹å‘å–æ•´ (åœ°æ¿)ã€‚" },
        { question: "è¦ç”¢ç”Ÿä¸€å€‹ 0 åˆ° 1 ä¹‹é–“çš„éš¨æ©Ÿå°æ•¸ã€‚", options: ["RANDOM", "RAND", "RND", "CHANCE"], answer: 1, explanation: "RAND() ä¸éœ€è¦åƒæ•¸ï¼Œå›å‚³ 0~1 ä¹‹é–“çš„éš¨æ©Ÿæ•¸ã€‚", example: "=RAND()", hint: "Keyword: Random (éš¨æ©Ÿ)ã€‚" },
        { question: "RAND() å‡½æ•¸æ¯æ¬¡é‡æ–°è¨ˆç®—è©¦ç®—è¡¨æ™‚ï¼Œæ•¸å€¼æœƒ...", options: ["ä¿æŒä¸è®Š", "è‡ªå‹•æ”¹è®Š", "è®Šæˆ 0", "è®Šæˆ 1"], answer: 1, explanation: "RAND æ˜¯æ˜“è®Šå‡½æ•¸ï¼Œæ¯æ¬¡æ“ä½œè©¦ç®—è¡¨éƒ½æœƒé‡æ–°ç”¢ç”Ÿæ–°æ•¸å­—ã€‚", example: "=RAND()", hint: "éš¨æ©Ÿæ•¸ (Random) ç•¶ç„¶æœƒè®Šã€‚" },
        { question: "æƒ³ç”¨ RAND ç”¢ç”Ÿä¸€å€‹ 0 åˆ° 10 ä¹‹é–“çš„éš¨æ©Ÿæ•¸ï¼Œå…¬å¼æ˜¯ï¼Ÿ", options: ["=RAND()+10", "=RAND()*10", "=RAND(10)", "=INT(10)"], answer: 1, explanation: "RAND() ç”¢ç”Ÿ 0~1ï¼Œä¹˜ä»¥ 10 å°±è®Šæˆ 0~10ã€‚", example: "=RAND()*10", hint: "0~1 è®Šæˆ 0~10ï¼Œè¦ä¹˜å¤§ 10 å€ã€‚" },
        { question: "å¦‚æœ A1 æ˜¯è² æ•¸ï¼Œé¡¯ç¤º \"Error\"ï¼Œå¦å‰‡è¨ˆç®— A1 çš„å¹³æ–¹æ ¹ã€‚", options: ["IF+SQRT", "SQRT", "ABS", "IF"], answer: 0, explanation: "å…ˆç”¨ IF æª¢æŸ¥æ˜¯å¦å°æ–¼0ï¼Œé¿å… SQRT å‡ºéŒ¯ã€‚", example: "=IF(A1<0, \"Error\", SQRT(A1))", hint: "å…ˆåˆ¤æ–· (If)ï¼Œå†è¨ˆç®—ã€‚" },
        { question: "è¦ç®—å‡ºå…¨ç­ã€ŒåŠæ ¼äººæ•¸ã€ä½”ã€Œç¸½äººæ•¸ã€çš„ç™¾åˆ†æ¯”ã€‚", options: ["COUNTIF / COUNTA", "SUM / COUNT", "AVERAGE", "RANK"], answer: 0, explanation: "å…ˆç”¨ COUNTIF ç®—åŠæ ¼äººæ•¸ï¼Œå†é™¤ä»¥ COUNTA ç®—å‡ºçš„ç¸½äººæ•¸ã€‚", example: "=COUNTIF(..)/COUNTA(..)", hint: "éƒ¨åˆ† (åŠæ ¼äººæ•¸) é™¤ä»¥ å…¨éƒ¨ (ç¸½äººæ•¸)ã€‚" }
    ];

    // --- ç¨‹å¼é‚è¼¯ ---
    let currentQuestionIndex = 0;
    let score = 0;
    let shuffledQuestions = [];

    // ç•«é¢æ§åˆ¶
    function goHome() {
        hideAllScreens();
        document.getElementById('start-screen').classList.remove('hidden');
    }

    function showRevision() {
        hideAllScreens();
        document.getElementById('revision-screen').classList.remove('hidden');
        switchTab('math'); // é è¨­é¡¯ç¤ºæ•¸å­¸
    }

    function hideAllScreens() {
        ['start-screen', 'revision-screen', 'quiz-screen', 'feedback-screen', 'end-screen'].forEach(id => {
            document.getElementById(id).classList.add('hidden');
        });
    }

    // --- æº«ç¿’ç­†è¨˜é‚è¼¯ ---
    function switchTab(category) {
        const tabs = document.querySelectorAll('.nav-tab');
        tabs.forEach(t => t.classList.remove('active'));
        
        // Find button with correct onclick
        const activeBtn = Array.from(tabs).find(btn => btn.getAttribute('onclick').includes(category));
        if(activeBtn) activeBtn.classList.add('active');

        const container = document.getElementById('notes-content');
        container.innerHTML = '';

        if (category === 'danger') {
            renderDangerZone(container);
        } else {
            renderCards(category, container);
        }
    }

    function speak(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = 0.8;
        window.speechSynthesis.speak(utterance);
    }

    function renderCards(category, container) {
        const list = notesData[category];
        const grid = document.createElement('div');
        grid.className = 'cards-grid';

        list.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'note-card';
            card.innerHTML = `
                <div class="card-header">
                    <span class="func-name">${item.name}</span>
                    <div style="display:flex; align-items:center; gap:5px;">
                        <button class="speak-btn" onclick="event.stopPropagation(); speak('${item.pronounce || item.name}')" title="ç™¼éŸ³">ğŸ”Š</button>
                        <span class="func-icon">${item.icon}</span>
                    </div>
                </div>
                <div><span class="root-word">${item.root}</span></div>
                <div class="hack-box">ğŸ¶ ${item.hack}</div>
                <div style="color:#555; font-size:0.9rem;">${item.desc}</div>
                <div class="toggle-example" onclick="toggleExample('ex-${category}-${index}')">ğŸ‘‡ é»æ“Šçœ‹ä¾‹å­</div>
                <div id="ex-${category}-${index}" class="example-content">
                    <code style="display:block; margin-bottom:5px;">${item.example}</code>
                    <div style="font-size:0.8rem; color:#666;">çµæœ: <b>${item.res}</b></div>
                </div>
            `;
            grid.appendChild(card);
        });
        container.appendChild(grid);
    }

    function renderDangerZone(container) {
        confusingPairs.forEach(pair => {
            const card = document.createElement('div');
            card.className = 'versus-card';
            card.innerHTML = `
                <div class="versus-header">ğŸ”¥ ${pair.title}</div>
                <div style="padding:10px; text-align:center; background:#fff7ed; border-bottom:1px solid #fee2e2;">
                    <div style="font-weight:bold; color:#b91c1c;">${pair.keyword}</div>
                    <div style="font-size:0.85rem; color:#666;">${pair.desc}</div>
                </div>
                <div class="versus-body">
                    <div class="v-half v-left">
                        <div style="font-weight:bold; color:#2563eb; margin-bottom:5px;">${pair.left.icon} ${pair.left.name}</div>
                        <span class="key-point">ğŸ‘‰ ${pair.left.meaning}</span>
                        <span class="key-point" style="background:white; padding:3px; border-radius:4px; margin-top:5px;">${pair.left.key}</span>
                    </div>
                    <div class="v-half v-right">
                        <div style="font-weight:bold; color:#ea580c; margin-bottom:5px;">${pair.right.icon} ${pair.right.name}</div>
                        <span class="key-point">ğŸ‘‰ ${pair.right.meaning}</span>
                        <span class="key-point" style="background:white; padding:3px; border-radius:4px; margin-top:5px;">${pair.right.key}</span>
                    </div>
                </div>
            `;
            container.appendChild(card);
        });
    }

    function toggleExample(id) {
        const el = document.getElementById(id);
        el.classList.toggle('show');
    }

    // --- æ¸¬é©—é‚è¼¯ ---
    function startGame() {
        hideAllScreens();
        document.getElementById('quiz-screen').classList.remove('hidden');
        
        currentQuestionIndex = 0;
        score = 0;
        const allQuestions = [...questionBank].sort(() => 0.5 - Math.random());
        shuffledQuestions = allQuestions.slice(0, 10);
        showQuestion();
    }

    function showQuestion() {
        const qData = shuffledQuestions[currentQuestionIndex];
        const totalQ = shuffledQuestions.length;
        document.getElementById('progress').style.width = `${((currentQuestionIndex)/totalQ)*100}%`;
        
        document.getElementById('question').innerHTML = 
            `<span style="font-size:0.8em; color:#666">ç¬¬ ${currentQuestionIndex + 1}/${totalQ} é¡Œ</span><br>${qData.question}`;
        
        // é‡ç½®ä¸¦è¨­å®šæç¤º
        const hintText = document.getElementById('hint-text');
        hintText.classList.remove('show');
        hintText.innerText = qData.hint || "æ­¤é¡Œæ²’æœ‰æç¤ºã€‚";

        const container = document.getElementById('options-container');
        container.innerHTML = '';
        qData.options.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(idx);
            container.appendChild(btn);
        });
    }

    function toggleHint() {
        const hintText = document.getElementById('hint-text');
        hintText.classList.toggle('show');
    }

    function checkAnswer(idx) {
        const qData = shuffledQuestions[currentQuestionIndex];
        const isCorrect = idx === qData.answer;
        if(isCorrect) score++;

        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('feedback-screen').classList.remove('hidden');
        
        const feedbackBox = document.getElementById('feedback-box');
        const resultTitle = document.getElementById('result-title');
        feedbackBox.className = 'feedback-container ' + (isCorrect ? 'correct' : 'wrong');
        resultTitle.innerHTML = isCorrect ? '<span style="color:#16a34a">âœ… ç­”å°äº†ï¼</span>' : `<span style="color:#dc2626">âŒ ç­”éŒ¯äº†ï¼</span> æ­£ç¢º: <strong>${qData.options[qData.answer]}</strong>`;
        
        document.getElementById('explanation-text').innerText = qData.explanation;
        document.getElementById('example-code').innerText = qData.example;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        document.getElementById('feedback-screen').classList.add('hidden');
        if (currentQuestionIndex < shuffledQuestions.length) {
            document.getElementById('quiz-screen').classList.remove('hidden');
            showQuestion();
        } else {
            endGame();
        }
    }

    function endGame() {
        document.getElementById('end-screen').classList.remove('hidden');
        document.getElementById('final-score').innerText = score;
        document.getElementById('total-questions').innerText = shuffledQuestions.length;
        document.getElementById('submit-section').classList.remove('hidden');
        document.getElementById('leaderboard-section').classList.add('hidden');
    }

    function submitScore() {
        const name = document.getElementById('player-name').value.trim();
        if (!name) { alert("è«‹è¼¸å…¥åå­—ï¼"); return; }
        
        const btn = document.querySelector('.btn-submit');
        btn.disabled = true;
        btn.innerText = "æäº¤ä¸­...";

        fetch(GAS_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name: name, score: score })
        }).then(() => {
            loadLeaderboard();
        }).catch(err => {
            alert("æäº¤å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡");
            btn.disabled = false;
        });
    }

    function loadLeaderboard() {
        document.getElementById('submit-section').classList.add('hidden');
        document.getElementById('leaderboard-section').classList.remove('hidden');
        const content = document.getElementById('leaderboard-content');
        
        fetch(GAS_URL)
        .then(response => response.json())
        .then(data => {
            let html = `<table class="leaderboard-table"><tr><th>æ’å</th><th>åå­—</th><th>å¾—åˆ†</th></tr>`;
            data.forEach((row, index) => {
                let rankClass = index === 0 ? 'rank-1' : (index === 1 ? 'rank-2' : (index === 2 ? 'rank-3' : ''));
                let rankIcon = index === 0 ? 'ğŸ¥‡' : (index === 1 ? 'ğŸ¥ˆ' : (index === 2 ? 'ğŸ¥‰' : index + 1));
                html += `<tr><td class="${rankClass}">${rankIcon}</td><td class="${rankClass}">${row.name}</td><td>${row.score}</td></tr>`;
            });
            html += `</table>`;
            content.innerHTML = html;
        })
        .catch(err => {
            content.innerText = "ç„¡æ³•è¼‰å…¥æ’è¡Œæ¦œ";
            console.error(err);
        });
    }
</script>
</body>
</html>
