<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITç‹—çš„å‡½æ•¸è£œç¿’ç­</title>
    <!-- å¼•å…¥ React å’Œ Tailwind CSS -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f9ff; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .animate-fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .flip-card-inner { transition: transform 0.6s; transform-style: preserve-3d; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- å®Œæ•´è³‡æ–™åº« (23å€‹å‡½æ•¸) - SUMIF æ›´æ–°ç‚º3åƒæ•¸ç‰ˆæœ¬ ---
        const functionData = {
            math: [
                { name: "SUM", pronounce: "Sum", root: "Summary", icon: "ğŸ’°", hack: "å…¨éƒ¨'æ£®'åŸ‹ä¸€é½Š (Sum)", desc: "åŠ ç¸½", example: "=SUM(A1:A10)", res: "ç¸½å’Œ" },
                { name: "SUMIF", pronounce: "Sum If", root: "Sum + If", icon: "ğŸ§", hack: "å¡«3æ ¼ï¼šæŸ¥é‚Šåº¦, æŸ¥å’©, åŠ é‚Šåº¦", desc: "æ¢ä»¶åŠ ç¸½ (é€šå¸¸æœ‰3å€‹åƒæ•¸)", example: "=SUMIF(A1:A10, \"Peter\", B1:B10)", res: "Peterçš„ç¸½åˆ†" },
                { name: "ABS", pronounce: "Abs", root: "Absolute", icon: "â•", hack: "å……æ»¿æ­£èƒ½é‡ (è®Šæ­£æ•¸)", desc: "çµ•å°å€¼", example: "=ABS(-50)", res: "50" },
                { name: "INT", pronounce: "Int", root: "Integer", icon: "ğŸª“", hack: "ç›´æ¥æ–¬è…³è¶¾ (æ¨å»å°æ•¸)", desc: "å–æ•´", example: "=INT(5.99)", res: "5" },
                { name: "ROUND", pronounce: "Round", root: "Round", icon: "â­•", hack: "åšäººè¦åœ“æ»‘ (å››æ¨äº”å…¥)", desc: "å››æ¨äº”å…¥", example: "=ROUND(5.99, 1)", res: "6.0" },
                { name: "SQRT", pronounce: "Square Root", root: "Square Root", icon: "ğŸŒ¿", hack: "SQ=æ­£æ–¹å½¢ Root=æ ¹", desc: "å¹³æ–¹æ ¹", example: "=SQRT(16)", res: "4" },
                { name: "RAND", pronounce: "Rand", root: "Random", icon: "ğŸ²", hack: "éš¨æ©ŸæŠ½ç", desc: "éš¨æ©Ÿæ•¸", example: "=RAND()", res: "0.238..." },
            ],
            logic: [
                { name: "IF", pronounce: "If", root: "If", icon: "ğŸ¤”", hack: "å¦‚æœ...å°±...å¦å‰‡... (3æ ¼)", desc: "æ¢ä»¶åˆ¤æ–·", example: "=IF(A1>=50, 'åŠæ ¼', 'è‚¥ä½¬')", res: "åŠæ ¼/è‚¥ä½¬" },
                { name: "AND", pronounce: "And", root: "And", icon: "ğŸ¤", hack: "A åŒåŸ‹ B (è²ªå¿ƒï¼Œå…©å€‹éƒ½è¦)", desc: "è€Œä¸”", example: "=AND(ä¸­>50, è‹±>50)", res: "TRUE" },
                { name: "OR", pronounce: "Or", root: "Or", icon: "ğŸ¤·", hack: "A æˆ–è€… B (éš¨ä¾¿ï¼Œä¸€å€‹å°±å¾—)", desc: "æˆ–è€…", example: "=OR(ä¸­>50, è‹±>50)", res: "TRUE" },
                { name: "NOT", pronounce: "Not", root: "Not", icon: "ğŸ™…", hack: "å”±åèª¿ (é»‘è®Šç™½)", desc: "ç›¸å", example: "=NOT(TRUE)", res: "FALSE" },
            ],
            stats: [
                { name: "AVERAGE", pronounce: "Average", root: "Average", icon: "âš–ï¸", hack: "Avg (å¹³å‡åˆ†)", desc: "å¹³å‡å€¼", example: "=AVERAGE(A1:A30)", res: "å¹³å‡åˆ†" },
                { name: "COUNT", pronounce: "Count", root: "Count", icon: "ğŸ”¢", hack: "é  (Count) æ‰‹æŒ‡æ•¸æ•¸å­—", desc: "æ•¸æ•¸å­—", example: "=COUNT(A1:A10)", res: "å€‹æ•¸" },
                { name: "COUNTA", pronounce: "Count A", root: "Count All", icon: "ğŸ” ", hack: "Count All (å…¨éƒ¨éƒ½æ•¸)", desc: "æ•¸éç©ºå€¼", example: "=COUNTA(A1:A10)", res: "å€‹æ•¸" },
                { name: "COUNTBLANK", pronounce: "Count Blank", root: "Count Blank", icon: "â¬œ", hack: "Blank å³ä¿‚ç™½å· (ç©ºæ ¼)", desc: "æ•¸ç©ºæ ¼", example: "=COUNTBLANK(A1:A10)", res: "ç©ºæ ¼æ•¸" },
                { name: "COUNTIF", pronounce: "Count If", root: "Count + If", icon: "ğŸ‘†", hack: "å¦‚æœä¿‚...å…ˆå¥½æ•¸ (2æ ¼)", desc: "æ¢ä»¶è¨ˆæ•¸", example: "=COUNTIF(A1:A10, \"M\")", res: "äººæ•¸" },
                { name: "MAX", pronounce: "Max", root: "Maximum", icon: "ğŸ”ï¸", hack: "Max å“¥æœ€å¼· (æœ€å¤§)", desc: "æœ€å¤§å€¼", example: "=MAX(A1:A30)", res: "æœ€å¤§å€¼" },
                { name: "MIN", pronounce: "Min", root: "Minimum", icon: "ğŸœ", hack: "Mini å¼Ÿè¿·ä½  (æœ€å°)", desc: "æœ€å°å€¼", example: "=MIN(A1:A30)", res: "æœ€å°å€¼" },
                { name: "RANK", pronounce: "Rank", root: "Ranking", icon: "ğŸ†", hack: "æ‰“æ©Ÿ Ranking (æ’å)", desc: "æ’å", example: "=RANK(A1, A$1:A$30)", res: "åæ¬¡" },
                { name: "MEDIAN", pronounce: "Median", root: "Median", icon: "ğŸ¯", hack: "Middle (åä¸­é–“ä½)", desc: "ä¸­ä½æ•¸", example: "=MEDIAN(A1:A10)", res: "ä¸­é–“å€¼" },
                { name: "MODE", pronounce: "Mode", root: "Mode", icon: "ğŸ”¥", hack: "Most (å‡ºç¾æœ€å¤šæ¬¡)", desc: "çœ¾æ•¸", example: "=MODE(A1:A10)", res: "çœ¾æ•¸" },
                { name: "LARGE", pronounce: "Large", root: "Large", icon: "ğŸ¥ˆ", hack: "Large (å¤§) -> ç¬¬ K å¤§", desc: "ç¬¬Kå¤§å€¼", example: "=LARGE(A1:A10, 2)", res: "ç¬¬2å¤§" },
                { name: "SMALL", pronounce: "Small", root: "Small", icon: "ğŸ¢", hack: "Small (ç´°) -> ç¬¬ K ç´°", desc: "ç¬¬Kå°å€¼", example: "=SMALL(A1:A10, 3)", res: "ç¬¬3å°" },
            ]
        };

        const confusingPairs = [
            {
                title: "SUMIF vs COUNTIF",
                keyword: "åŠ éŒ¢ vs æ•¸äºº",
                desc: "è¨˜ä½ï¼šSUMIF é€šå¸¸å¡« 3 æ ¼ï¼ŒCOUNTIF å¡« 2 æ ¼ã€‚",
                left: { name: "SUMIF", icon: "ğŸ’µ", meaning: "Sum (åŠ ç¸½) + If", key: "æŸ¥é‚Šåº¦, æŸ¥å’©, åŠ é‚Šåº¦ (3æ ¼)", ex: "åœ¨Aæ¬„æŸ¥'Peter'ï¼ŒåŠ Bæ¬„çš„åˆ†æ•¸" },
                right: { name: "COUNTIF", icon: "ğŸ‘†", meaning: "Count (è¨ˆæ•¸) + If", key: "æŸ¥é‚Šåº¦, æŸ¥å’© (2æ ¼)", ex: "åœ¨Aæ¬„æŸ¥æœ‰å¹¾å€‹'Peter' (ä¸æ¶‰åŠBæ¬„)" }
            },
            {
                title: "COUNT vs COUNTA",
                keyword: "æ•¸å­— vs å…¨éƒ¨",
                desc: "å¦‚æœæ ¼å­è£¡æ˜¯æ–‡å­— (å¦‚ 'ç¼ºå¸­')ï¼Œå°å¿ƒç”¨éŒ¯ï¼",
                left: { name: "COUNT", icon: "ğŸ”¢", meaning: "åªæ•¸æ•¸å­—", key: "1, 2, 3...", ex: "åªè¨ˆç®—æœ‰å¡«ã€åˆ†æ•¸ã€‘çš„äºº" },
                right: { name: "COUNTA", icon: "ğŸ” ", meaning: "Count All (å…¨éƒ¨)", key: "æ•¸å­— + æ–‡å­— (A=All)", ex: "è¨ˆç®—ã€æœ‰å‡ºå¸­ã€‘(æœ‰å¡«ä»»ä½•é‡) çš„äºº" }
            },
            {
                title: "INT vs ROUND",
                keyword: "æ–¬è…³ vs å››æ¨äº”å…¥",
                desc: "éƒ½ä¿‚è®Šæ•´æ•¸ï¼Œä½†æ‰‹æ³•ä¸åŒã€‚",
                left: { name: "INT", icon: "ğŸª“", meaning: "Integer (å–æ•´)", key: "ç„¡æ¢ä»¶æ¨å» (æ–¬è…³è¶¾)", ex: "5.9 â¡ï¸ 5" },
                right: { name: "ROUND", icon: "â­•", meaning: "Round (åœ“æ»‘)", key: "å››æ¨äº”å…¥ (ç‡ä¸‹ä¸€ä½)", ex: "5.9 â¡ï¸ 6" }
            }
        ];

        // --- çµ„ä»¶: ITç‹— ---
        const Mascot = ({ emotion, text }) => {
            const getEmoji = () => {
                switch(emotion) {
                    case 'happy': return 'ğŸ¶';
                    case 'smart': return 'ğŸ¤“';
                    case 'warn': return 'âš ï¸';
                    default: return 'ğŸ•';
                }
            };
            return (
                <div className="flex items-start bg-white p-4 rounded-xl shadow-lg border-2 border-blue-500 mb-6 relative animate-fade-in">
                    <div className="text-5xl mr-4">{getEmoji()}</div>
                    <div className="speech-bubble bg-blue-100 p-3 rounded-lg relative w-full">
                        <p className="font-bold text-blue-800 text-lg">IT ç‹—æ—ºè²¡ï¼š</p>
                        <p className="text-gray-700">{text}</p>
                    </div>
                </div>
            );
        };

        // --- çµ„ä»¶: å‡½æ•¸å¡ç‰‡ (æ›´æ–°ç™¼éŸ³é‚è¼¯) ---
        const FunctionCard = ({ item }) => {
            const [flipped, setFlipped] = useState(false);

            const speak = (e, text) => {
                e.stopPropagation();
                // å„ªå…ˆä½¿ç”¨ pronounce æ¬„ä½ï¼Œå¦‚æœæ²’æœ‰å‰‡ä½¿ç”¨ name
                const textToSpeak = item.pronounce || text;
                const utterance = new SpeechSynthesisUtterance(textToSpeak);
                utterance.lang = 'en-US';
                utterance.rate = 0.8; // ç¨å¾®æ…¢ä¸€é»
                window.speechSynthesis.speak(utterance);
            };

            return (
                <div 
                    className="bg-white rounded-xl shadow-md card-hover border border-gray-100 cursor-pointer h-full relative overflow-hidden group"
                    onClick={() => setFlipped(!flipped)}
                >
                    {/* æ­£é¢ */}
                    <div className={`p-5 h-full flex flex-col justify-between ${flipped ? 'hidden' : 'block'}`}>
                        <div>
                            <div className="flex justify-between items-center mb-1">
                                <h3 className="text-2xl font-bold text-blue-600">{item.name}</h3>
                                <div className="flex items-center gap-2">
                                    <button 
                                        onClick={(e) => speak(e, item.name)}
                                        className="text-gray-400 hover:text-blue-500 transition-colors p-1 rounded-full hover:bg-blue-50"
                                        title="ç™¼éŸ³"
                                    >
                                        ğŸ”Š
                                    </button>
                                    <span className="text-3xl">{item.icon}</span>
                                </div>
                            </div>
                            
                            <div className="mb-3">
                                <span className="text-xs font-bold text-gray-400 uppercase tracking-wider">è‹±æ–‡åŸæ„</span>
                                <p className="text-sm font-medium text-gray-600 font-mono bg-gray-50 px-2 py-1 rounded border border-gray-200 inline-block mt-1">
                                    {item.root}
                                </p>
                            </div>

                            <p className="text-sm text-gray-500 mb-2">{item.desc}</p>
                        </div>
                        
                        <div className="bg-yellow-50 p-2 rounded border border-yellow-100 mt-2">
                            <span className="text-[10px] font-bold text-yellow-600 block">ğŸ§  è¨˜æ†¶å£è¨£ï¼š</span>
                            <p className="text-sm text-yellow-800 font-bold">{item.hack}</p>
                        </div>
                        
                        <p className="text-xs text-blue-400 mt-2 text-center animate-pulse">ğŸ‘† é»æ“Šçœ‹ä¾‹å­</p>
                    </div>

                    {/* èƒŒé¢ (ç¿»è½‰å¾Œ) */}
                    <div className={`p-5 h-full bg-blue-50 flex flex-col justify-center ${flipped ? 'block' : 'hidden'} animate-fade-in`}>
                         <div className="flex justify-between items-center mb-2">
                            <h3 className="text-xl font-bold text-blue-600">{item.name}</h3>
                            <button 
                                onClick={(e) => speak(e, item.name)}
                                className="text-blue-400 hover:text-blue-600"
                            >
                                ğŸ”Š
                            </button>
                        </div>
                        <div className="bg-white p-3 rounded-lg border border-blue-100 shadow-sm">
                            <p className="font-bold text-green-700 mb-1 text-xs">ğŸ’¡ ä¾‹å­ï¼š</p>
                            <code className="block bg-gray-800 text-green-400 p-2 rounded text-xs mb-1 break-all">{item.example}</code>
                            <p className="text-xs text-gray-600 mt-2 border-t pt-1">çµæœï¼š<span className="font-bold text-gray-800">{item.res}</span></p>
                        </div>
                        <button className="mt-4 text-xs text-blue-500 underline text-center">è¿”å›è¨˜æ†¶å¡</button>
                    </div>
                </div>
            );
        };

        // --- çµ„ä»¶: å°æ±ºå¡ç‰‡ (æ˜“æ··æ·†) ---
        const VersusCard = ({ pair }) => {
            return (
                <div className="bg-white rounded-2xl shadow-xl overflow-hidden border-4 border-red-100 mb-8 transform transition hover:scale-[1.01]">
                    <div className="bg-red-500 text-white p-3 text-center font-bold text-xl">
                        ğŸ”¥ {pair.title} ğŸ”¥
                    </div>
                    <div className="p-4 text-center bg-red-50 border-b border-red-100">
                        <p className="text-red-800 font-bold mb-1">{pair.keyword}</p>
                        <p className="text-sm text-gray-600">{pair.desc}</p>
                    </div>
                    <div className="grid grid-cols-2 divide-x divide-gray-200">
                        {/* å·¦é‚Šé¸æ‰‹ */}
                        <div className="p-4 bg-blue-50 hover:bg-blue-100 transition-colors">
                            <div className="text-center mb-2">
                                <span className="text-4xl block mb-2">{pair.left.icon}</span>
                                <h4 className="text-xl font-bold text-blue-700">{pair.left.name}</h4>
                            </div>
                            <div className="space-y-2 text-sm">
                                <p className="bg-white p-2 rounded shadow-sm">
                                    <span className="font-bold text-gray-500 block text-xs">æ„æ€ï¼š</span>
                                    {pair.left.meaning}
                                </p>
                                <p className="bg-white p-2 rounded shadow-sm border-l-4 border-blue-500">
                                    <span className="font-bold text-gray-500 block text-xs">è¨˜æ†¶æ³•ï¼š</span>
                                    {pair.left.key}
                                </p>
                                <p className="text-gray-600 italic mt-2 text-xs">"{pair.left.ex}"</p>
                            </div>
                        </div>

                        {/* å³é‚Šé¸æ‰‹ */}
                        <div className="p-4 bg-orange-50 hover:bg-orange-100 transition-colors">
                            <div className="text-center mb-2">
                                <span className="text-4xl block mb-2">{pair.right.icon}</span>
                                <h4 className="text-xl font-bold text-orange-700">{pair.right.name}</h4>
                            </div>
                            <div className="space-y-2 text-sm">
                                <p className="bg-white p-2 rounded shadow-sm">
                                    <span className="font-bold text-gray-500 block text-xs">æ„æ€ï¼š</span>
                                    {pair.right.meaning}
                                </p>
                                <p className="bg-white p-2 rounded shadow-sm border-l-4 border-orange-500">
                                    <span className="font-bold text-gray-500 block text-xs">è¨˜æ†¶æ³•ï¼š</span>
                                    {pair.right.key}
                                </p>
                                <p className="text-gray-600 italic mt-2 text-xs">"{pair.right.ex}"</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // --- ä¸»ç¨‹å¼ ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('math');

            const renderContent = () => {
                if (activeTab === 'danger') {
                    return (
                        <div className="animate-fade-in pb-20">
                            <Mascot 
                                emotion="warn" 
                                text="æ±ªï¼é€™è£¡æ˜¯ã€Œæ˜“æ··æ·†ç‰¹å€ã€ï¼èªä½ D é—œéµå­— (Keyword)ï¼Œè¦‹åˆ° 'Total' å°±è«— Sumï¼Œè¦‹åˆ° 'How many' å°±è«— Countï¼" 
                            />
                            {confusingPairs.map((pair, idx) => (
                                <VersusCard key={idx} pair={pair} />
                            ))}
                        </div>
                    );
                }

                let data = [];
                let introText = "";

                if (activeTab === 'math') {
                    data = functionData.math;
                    introText = `æ•¸å­¸æ´¾ï¼šæ’³å€‹å–‡å­ä»” ğŸ”Š è½ä¸‹å€‹å­—é»è®€ï¼è¨˜ä½ã€Œæ£®ã€åŸ‹ä¸€é½Šå°±ä¿‚ SUMï¼Œåœ“æ»‘åšäººå°±ä¿‚ ROUNDï¼`;
                } else if (activeTab === 'logic') {
                    data = functionData.logic;
                    introText = `é‚è¼¯æ´¾ï¼šIF ä¿‚å¤§ä½¬ï¼Œè¨˜ä½ã€Œå¦‚æœ...å°±...ã€ã€‚æ‹†é–‹å€‹è‹±æ–‡å­—é»è¨˜ï¼Œå¥½ç°¡å–®ï¼`;
                } else if (activeTab === 'stats') {
                    data = functionData.stats;
                    introText = `çµ±è¨ˆæ´¾ï¼šCOUNT å®¶æ—æœ€ç…©ï¼Œè¨˜ä½åŠ å·¦ A å°±ä¿‚ All (å…¨éƒ¨æ•¸)ï¼ŒåŠ å·¦ Blank å°±ä¿‚ç™½å· (ç©ºæ ¼)ï¼`;
                }

                return (
                    <div className="pb-20">
                        <Mascot emotion="happy" text={introText} />
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            {data.map((item, idx) => (
                                <FunctionCard key={idx} item={item} />
                            ))}
                        </div>
                    </div>
                );
            };

            return (
                <div className="max-w-md mx-auto min-h-screen bg-gray-50 shadow-2xl overflow-hidden relative">
                    {/* Header */}
                    <div className="bg-blue-600 p-6 text-white rounded-b-3xl shadow-lg relative z-10">
                        <div className="flex items-center justify-between">
                            <div>
                                <h1 className="text-2xl font-bold">ITç‹—çš„å‡½æ•¸è£œç¿’ç­</h1>
                                <p className="text-blue-200 text-sm">è‹±æ–‡å·®ï¼Ÿè½è²ã€æ‹†å­—ã€è¨˜å£è¨£ï¼ğŸ¶</p>
                            </div>
                            <div className="text-4xl bg-white rounded-full p-1 shadow-inner">ğŸ•</div>
                        </div>
                    </div>

                    {/* Navigation */}
                    <div className="flex justify-around p-4 bg-white shadow-sm sticky top-0 z-20 overflow-x-auto">
                        {[
                            { id: 'math', label: 'æ•¸å­¸æ´¾', icon: 'ğŸ”¢', count: functionData.math.length },
                            { id: 'logic', label: 'é‚è¼¯æ´¾', icon: 'ğŸ§ ', count: functionData.logic.length },
                            { id: 'stats', label: 'çµ±è¨ˆæ´¾', icon: 'ğŸ“Š', count: functionData.stats.length },
                            { id: 'danger', label: 'æ˜“æ··æ·†', icon: 'ğŸš¨', count: 3 }
                        ].map(tab => (
                            <button
                                key={tab.id}
                                onClick={() => setActiveTab(tab.id)}
                                className={`flex flex-col items-center min-w-[65px] p-2 rounded-xl transition-all ${
                                    activeTab === tab.id 
                                    ? (tab.id === 'danger' ? 'bg-red-100 text-red-600 font-bold transform scale-110 shadow-md' : 'bg-blue-100 text-blue-600 font-bold transform scale-110 shadow-md') 
                                    : 'text-gray-400 hover:bg-gray-100'
                                }`}
                            >
                                <span className="text-xl mb-1">{tab.icon}</span>
                                <span className="text-xs">{tab.label}</span>
                                <span className="text-[10px] bg-gray-200 px-1.5 rounded-full mt-1 text-gray-500">{tab.count}å€‹</span>
                            </button>
                        ))}
                    </div>

                    {/* Content Area */}
                    <div className="p-4 min-h-[500px]">
                        {renderContent()}
                    </div>

                    {/* Floating Action Button (Go to Quiz) */}
                    <div className="fixed bottom-6 right-6 z-50">
                         <a href="https://ccn-t27.github.io/spreadsheet-game/excel_game.html" target="_blank" className="flex items-center gap-2 bg-yellow-400 text-yellow-900 px-5 py-3 rounded-full font-bold shadow-lg hover:bg-yellow-300 transition-transform hover:scale-105 animate-bounce border-2 border-yellow-200">
                            <span>ğŸ® å»æ¸¬é©—ï¼</span>
                        </a>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
